<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ä°nteraktif Masal Testi</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f2f5;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            margin: 0;
        }

        h1 {
            color: #333;
            margin-bottom: 20px;
        }

        /* Video AlanÄ± ve Overlay KapsayÄ±cÄ±sÄ± */
        .video-container {
            position: relative;
            width: 800px;
            max-width: 100%;
            aspect-ratio: 16/9;
            background: #000;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            border-radius: 12px;
            overflow: hidden;
        }

        #player {
            width: 100%;
            height: 100%;
        }

        /* Soru EkranÄ± (Overlay) */
        .quiz-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(30, 30, 30, 0.95);
            display: none; /* BaÅŸlangÄ±Ã§ta gizli */
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            box-sizing: border-box;
            color: white;
            z-index: 10;
        }

        .question-text {
            font-size: 1.5rem;
            text-align: center;
            margin-bottom: 20px;
            font-weight: bold;
            color: #fff;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            width: 90%;
        }

        .option-btn {
            background-color: #3a3a3a;
            border: 2px solid #555;
            color: white;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.2s;
            text-align: left;
        }

        .option-btn:hover {
            background-color: #505050;
            border-color: #777;
        }

        /* DoÄŸru/YanlÄ±ÅŸ Renkleri */
        .option-btn.correct {
            background-color: #2ecc71 !important;
            border-color: #27ae60 !important;
        }

        .option-btn.wrong {
            background-color: #e74c3c !important;
            border-color: #c0392b !important;
        }

        /* Puan Tablosu */
        .score-board {
            margin-top: 20px;
            background: white;
            padding: 15px 30px;
            border-radius: 50px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            font-size: 1.2rem;
            font-weight: bold;
            color: #333;
        }

        .feedback-msg {
            margin-top: 15px;
            font-size: 1.2rem;
            font-weight: bold;
            min-height: 30px;
        }
        
        .continue-btn {
            margin-top: 20px;
            padding: 10px 25px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 1rem;
            cursor: pointer;
            display: none;
        }

        @media (max-width: 600px) {
            .options-grid {
                grid-template-columns: 1fr;
            }
            .question-text {
                font-size: 1.1rem;
            }
        }
    </style>
</head>
<body>

    <h1>ğŸ¬ AkÄ±llÄ± Video Ders</h1>

    <div class="video-container">
        <div id="player"></div>

        <div id="quizOverlay" class="quiz-overlay">
            <div id="questionText" class="question-text">Soru buraya gelecek...</div>
            <div id="optionsGrid" class="options-grid">
                </div>
            <div id="feedbackMsg" class="feedback-msg"></div>
            <button id="continueBtn" class="continue-btn" onclick="resumeVideo()">Devam Et â–¶</button>
        </div>
    </div>

    <div class="score-board">
        Puan: <span id="score">0</span> / 80
    </div>

    <script>
        // --- 1. SORU VERÄ°TABANI ---
        // Zamanlamalar, sorunun sorulacaÄŸÄ± saniye (bitiÅŸ zamanÄ±) olarak ayarlanmÄ±ÅŸtÄ±r.
        const questions = [
            {
                time: 20, // 00:00:20
                question: "KurbaÄŸa ile fare nasÄ±l bir iliÅŸkiye sahiptir?",
                options: ["A) DÃ¼ÅŸmanlardÄ±r", "B) KomÅŸudurlar", "C) ArkadaÅŸtÄ±rlar", "D) AkrabadÄ±rlar"],
                correct: 2 // C ÅŸÄ±kkÄ± (0, 1, 2)
            },
            {
                time: 42, // 00:00:42
                question: "Fare, kurbaÄŸanÄ±n sesini neden duyamamaktadÄ±r?",
                options: ["A) KurbaÄŸa Ã§ok kÄ±sÄ±k sesle konuÅŸtuÄŸu iÃ§in", "B) IrmaÄŸÄ±n su sesi bastÄ±rdÄ±ÄŸÄ± iÃ§in", "C) Fare kulaklarÄ±nÄ± kaybettiÄŸi iÃ§in", "D) KurbaÄŸa sudan hiÃ§ Ã§Ä±kmadÄ±ÄŸÄ± iÃ§in"],
                correct: 1 // B ÅŸÄ±kkÄ±
            },
            {
                time: 65, // 00:01:05
                question: "KurbaÄŸa, birbirlerini daha kolay bulmalarÄ± iÃ§in ne Ã¶nermiÅŸtir?",
                options: ["A) Her gÃ¼n aynÄ± saatte buluÅŸmayÄ±", "B) Birbirlerine baÄŸÄ±rmayÄ±", "C) AyaklarÄ±na ip baÄŸlamayÄ±", "D) IrmaÄŸÄ±n ortasÄ±nda beklemeyi"],
                correct: 2 // C ÅŸÄ±kkÄ±
            },
            {
                time: 85, // 00:01:25
                question: "Fare, ipi nereden bulmuÅŸtur?",
                options: ["A) Ormandan", "B) IrmaÄŸÄ±n kenarÄ±ndan", "C) BaÅŸka bir hayvandan", "D) GirdiÄŸi bir evden"],
                correct: 3 // D ÅŸÄ±kkÄ±
            },
            {
                time: 102, // 00:01:42
                question: "Fare, kurbaÄŸaya giderken hangi hayvan tarafÄ±ndan yakalanmÄ±ÅŸtÄ±r?",
                options: ["A) Kartal", "B) Karga", "C) Åahin", "D) BaykuÅŸ"],
                correct: 1 // B ÅŸÄ±kkÄ±
            },
            {
                time: 105, // 00:01:45
                question: "Fare karga tarafÄ±ndan yakalanÄ±nca kurbaÄŸaya ne olmuÅŸtur?",
                options: ["A) IrmaÄŸa dÃ¼ÅŸmÃ¼ÅŸtÃ¼r", "B) KaÃ§mayÄ± baÅŸarmÄ±ÅŸtÄ±r", "C) GÃ¶kyÃ¼zÃ¼ne doÄŸru yÃ¼kselmiÅŸtir", "D) Ä°pi Ã§Ã¶zmÃ¼ÅŸtÃ¼r"],
                correct: 2 // C ÅŸÄ±kkÄ±
            },
            {
                time: 120, // 00:02:00
                question: "KurbaÄŸa, baÅŸÄ±na gelenlerin sebebini neye baÄŸlamÄ±ÅŸtÄ±r?",
                options: ["A) YanlÄ±ÅŸ ip seÃ§mesine", "B) KarganÄ±n aÃ§gÃ¶zlÃ¼lÃ¼ÄŸÃ¼ne", "C) Denginde olmayan fareyle arkadaÅŸ olmasÄ±na", "D) IrmaÄŸa Ã§ok yaklaÅŸmasÄ±na"],
                correct: 2 // C ÅŸÄ±kkÄ±
            },
            {
                time: 130, // 00:02:10
                question: "MasalÄ±n sonunda insanlar hangi atasÃ¶zÃ¼yle ders vermiÅŸtir?",
                options: ["A) KomÅŸu komÅŸunun kÃ¼lÃ¼ne muhtaÃ§tÄ±r", "B) Sakla samanÄ± gelir zamanÄ±", "C) EÅŸ eÅŸini bulmayÄ±nca halimiz yaman olur", "D) AzÄ±cÄ±k aÅŸÄ±m kaygÄ±sÄ±z baÅŸÄ±m"],
                correct: 2 // C ÅŸÄ±kkÄ±
            }
        ];

        // --- 2. DEÄÄ°ÅKENLER ---
        var player;
        var score = 0;
        var currentQuestionIndex = 0;
        var isQuizActive = false;
        var timerInterval;

        // --- 3. YOUTUBE API KURULUMU ---
        var tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        function onYouTubeIframeAPIReady() {
            player = new YT.Player('player', {
                height: '100%',
                width: '100%',
                videoId: 'SWHZPEg-Pns', // Video ID
                playerVars: {
                    'controls': 1,
                    'rel': 0,
                    'modestbranding': 1
                },
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                }
            });
        }

        function onPlayerReady(event) {
            // Video hazÄ±r, zamanlayÄ±cÄ±yÄ± baÅŸlat
            startTracking();
        }

        function onPlayerStateChange(event) {
            if (event.data == YT.PlayerState.PLAYING) {
                startTracking();
            } else {
                stopTracking();
            }
        }

        // --- 4. ZAMAN TAKÄ°BÄ° VE SORU TETÄ°KLEME ---
        function startTracking() {
            stopTracking(); // Ã–ncekini temizle
            timerInterval = setInterval(checkTime, 500); // YarÄ±m saniyede bir kontrol et
        }

        function stopTracking() {
            clearInterval(timerInterval);
        }

        function checkTime() {
            if (!player || !player.getCurrentTime) return;
            
            let currentTime = player.getCurrentTime();

            // HenÃ¼z sorulmamÄ±ÅŸ ve zamanÄ± gelmiÅŸ bir soru var mÄ±?
            // currentQuestionIndex < questions.length kontrolÃ¼ ile tÃ¼m sorular bitti mi bakarÄ±z
            if (currentQuestionIndex < questions.length && !isQuizActive) {
                let q = questions[currentQuestionIndex];
                
                // ZamanÄ± geldiyse (veya geÃ§tiyse ama Ã§ok da geÃ§mediyse, 2 sn tolerans)
                if (currentTime >= q.time && currentTime < q.time + 2) {
                    triggerQuestion(q);
                }
            }
        }

        // --- 5. SORU ARAYÃœZÃœ Ä°ÅLEMLERÄ° ---
        function triggerQuestion(q) {
            isQuizActive = true;
            player.pauseVideo();
            
            // ArayÃ¼zÃ¼ hazÄ±rla
            document.getElementById('quizOverlay').style.display = 'flex';
            document.getElementById('questionText').innerText = "â“ " + q.question;
            document.getElementById('feedbackMsg').innerText = "";
            document.getElementById('continueBtn').style.display = 'none';
            
            const optionsGrid = document.getElementById('optionsGrid');
            optionsGrid.innerHTML = ''; // Eski ÅŸÄ±klarÄ± temizle

            q.options.forEach((opt, index) => {
                let btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.innerText = opt;
                btn.onclick = () => checkAnswer(index, q.correct, btn);
                optionsGrid.appendChild(btn);
            });
        }

        function checkAnswer(selectedIndex, correctIndex, btnElement) {
            // ÅÄ±klara tÄ±klamayÄ± devre dÄ±ÅŸÄ± bÄ±rak
            const allBtns = document.querySelectorAll('.option-btn');
            allBtns.forEach(b => b.disabled = true);

            const feedback = document.getElementById('feedbackMsg');

            if (selectedIndex === correctIndex) {
                // DOÄRU
                btnElement.classList.add('correct');
                score += 10;
                document.getElementById('score').innerText = score;
                feedback.innerText = "âœ… Harika! DoÄŸru cevap.";
                feedback.style.color = "#2ecc71";
            } else {
                // YANLIÅ
                btnElement.classList.add('wrong');
                // DoÄŸru olanÄ± da yeÅŸil yapalÄ±m ki Ã¶ÄŸrenci gÃ¶rsÃ¼n
                allBtns[correctIndex].classList.add('correct');
                feedback.innerText = "âŒ Maalesef yanlÄ±ÅŸ. DoÄŸru cevap yeÅŸil ile iÅŸaretlendi.";
                feedback.style.color = "#e74c3c";
            }

            // Devam et butonunu gÃ¶ster
            document.getElementById('continueBtn').style.display = 'block';
        }

        function resumeVideo() {
            document.getElementById('quizOverlay').style.display = 'none';
            isQuizActive = false;
            currentQuestionIndex++; // Bir sonraki soruya geÃ§mek iÃ§in indeksi artÄ±r
            player.playVideo();
        }

    </script>
</body>
</html>